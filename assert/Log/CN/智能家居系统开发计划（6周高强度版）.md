# 智能家居系统开发计划（6周高强度版）

## 第1周：概念设计与系统架构

### 户型与家居规划（1-2天）

- 设计紧凑型演示用客厅模型
- 规划智能设备位置：照明、风扇、空调、窗帘
- 确定边缘计算服务器的中央控制站位置

### 设备选型（1-2天）

- 智能设备包括
  - 照明（客厅、卧室、厨房、书房）
  - 风扇（客厅、卧室）
  - 空调（客厅、卧室）
  - 窗帘（客厅、卧室）
  - 传感器：麦克风、CO2、VOC、温湿度传感器

### 系统架构设计（2-3天）

- **中央系统**：
  - 边缘服务器（Mac mini M4或同等设备运行Docker服务）
  - 核心功能：LLM处理、服务协调、语义理解
  - 服务组件：Ollama、Coordinator、STT、TTS、IoT Control
- **智能设备设计**：
  - 每个设备配备专用MCU（ESP32系列）
  - 两个主要ESP32板：（意图式）
    1. 语音/音频处理ESP32（已有代码基础）
    2. 表情显示ESP32（带LCD）（已有代码基础）

## 第2周：MCU选型与电路设计

### MCU选型（2天）

- 基于功能需求选择合适的MCU：
  - **主音频ESP32**：ESP32-WROOM（支持I2S，连接麦克风/扬声器）
  - **显示ESP32**：ESP32-WROVER（带PSRAM，处理显示功能）
  - **设备MCU**：ESP32-C3或ESP8266（简单设备控制的低成本选择）

### 电路设计（3-4天）

- 为每种设备类型设计最小可行电路
- 参考资料：
  - 立创开源广场组件库
  - ESP32官方原理图
  - GitHub开源智能家居项目
- 设计供电方案（中央供电vs设备独立供电）
- 完成最小成本电路设计初稿

### 物理模型选材与设计（1-2天）

- 选择轻量级、经济实惠的材料
- 确定最终展示形式：
  1. 传统智能家居模式
  2. API辅助家居模式
  3. 本地化部署语义智能家居模式
- 制定模型构建计划

## 第3周：PCB设计与软件框架搭建

### PCB设计（3天）

- 设计以下PCB布局：
  - 中央控制板
  - 智能设备控制板（照明、风扇、空调、窗帘）
  - 传感器集成板
- 使用KiCad或立创EDA进行设计
- 准备好BOM清单并下单PCB

### Docker环境搭建（2天）

- 根据docker-compose.yml配置Docker环境
- 部署5个服务：Ollama、STT、TTS、IoT Control、Coordinator
- 测试服务间通信

### ESP32基础固件开发（2天）

- 为音频处理ESP32开发基本功能
- 为显示ESP32开发基本功能
- 创建WiFi、MQTT通信公共库

## 第4周：硬件组装与软件集成

### PCB制造与组装（3天）

- PCB板制造完成
- 采购并焊接元器件
- 测试基本电路功能

### 物理模型构建（2天）

- 组装小型智能家居模型
- 整合PCB和设备
- 设置电源分配

### 边缘计算实现（2天）

- 使用Llama3:8b或类似模型配置Ollama
- 实现基础语义理解框架
- 开发意图提取算法

## 第5周：系统集成与语义框架优化

### 软件集成（3天）

- 在边缘计算设备上部署Docker服务
- 为所有ESP32设备刷入固件
- 建立设备间的WebSocket/MQTT通信

### 语义框架增强（3天）

- 实现意图提取优化算法
- 开发语义通信协议
- 测试性能改进

### 基础功能测试（1天）

- 测试单个设备控制功能
- 测试语音识别和合成
- 测试表情显示

## 第6周：演示模式开发与最终调试

### 演示界面开发（2天）

- 完善Web仪表盘进行监控和控制
- 开发多种演示模式之间的切换功能
- 实现物理模式选择器（开关/旋钮/按钮）

### 系统测试与性能评估（2天）

- 进行全面的端到端测试
- 测量响应时间和准确性
- 比较不同模式下的性能

### 最终组装与调试（2天）

- 完成所有硬件集成
- 最终软件部署与调试
- 编写演示脚本与材料
- 制作简要用户手册

## 急速开发关键点

1. **并行工作**:
   - 同时进行软件开发和硬件设计
   - 在等待PCB制造时完成软件框架
2. **利用现有代码**:
   - 充分利用已有的Docker配置和服务代码
   - 使用ESP32现有代码基础快速开发
3. **简化设计**:
   - 先实现最小可行产品
   - 保留核心功能，删减次要功能
4. **模块化开发**:
   - 将系统分解为独立模块
   - 各模块可并行开发和测试
5. **快速原型**:
   - 使用面包板快速测试电路
   - 在PCB制造前验证关键电路
6. **选用成熟组件**:
   - 优先选择现成模块而非自行设计
   - 使用ESP32开发板代替自定义PCB（如有必要）

这个6周的高强度计划主要侧重于快速实现核心功能，确保在有限时间内完成大部分开发工作。根据实际进展情况，可以进一步调整时间表，必要时可以简化部分功能以确保核心研究问题得到解决。